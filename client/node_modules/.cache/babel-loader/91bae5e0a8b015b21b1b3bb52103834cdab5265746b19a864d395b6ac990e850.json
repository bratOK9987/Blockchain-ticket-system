{"ast":null,"code":"import Web3 from 'web3';\nimport configuration from '../../build/contracts/Tickets.json';\nimport 'bootstrap/dist/css/bootstrap.css';\nimport ticketImage from './images/ticket.png';\nconst createElementFromString = string => {\n  const el = document.createElement('div');\n  el.innerHTML = string;\n  return el.firstChild;\n};\nconst CONTRACT_ADDRESS = configuration.networks['5777'].address;\nconst CONTRACT_ABI = configuration.abi;\nconst web3 = new Web3(Web3.givenProvider || 'http://127.0.0.1:7545');\nconst contract = new web3.eth.Contract(CONTRACT_ABI, CONTRACT_ADDRESS);\nlet account;\nconst accountEl = document.getElementById('account');\nconst ticketsEl = document.getElementById('tickets');\nconst TOTAL_TICKETS = 10;\nconst EMPTY_ADDRESS = '0x0000000000000000000000000000000000000000';\nconst buyTicket = async ticket => {\n  await contract.methods.buyTicket(ticket.id).send({\n    from: account,\n    value: ticket.price\n  });\n};\nconst refreshTickets = async () => {\n  ticketsEl.innerHTML = '';\n  for (let i = 0; i < TOTAL_TICKETS; i++) {\n    const ticket = await contract.methods.tickets(i).call();\n    ticket.id = i;\n    if (ticket.owner === EMPTY_ADDRESS) {\n      const ticketEl = createElementFromString(`<div class=\"ticket card\" style=\"width: 18rem;\">\n          <img src=\"${ticketImage}\" class=\"card-img-top\" alt=\"...\">\n          <div class=\"card-body\">\n            <h5 class=\"card-title\">Ticket</h5>\n            <p class=\"card-text\">${ticket.price / 1e18} Eth</p>\n            <button class=\"btn btn-primary\">Buy Ticket</button>\n          </div>\n        </div>`);\n      ticketEl.onclick = buyTicket.bind(null, ticket);\n      ticketsEl.appendChild(ticketEl);\n    }\n  }\n};\nconst main = async () => {\n  const accounts = await web3.eth.requestAccounts();\n  account = accounts[0];\n  accountEl.innerText = account;\n  await refreshTickets();\n};\nmain();","map":{"version":3,"names":["Web3","configuration","ticketImage","createElementFromString","string","el","document","createElement","innerHTML","firstChild","CONTRACT_ADDRESS","networks","address","CONTRACT_ABI","abi","web3","givenProvider","contract","eth","Contract","account","accountEl","getElementById","ticketsEl","TOTAL_TICKETS","EMPTY_ADDRESS","buyTicket","ticket","methods","id","send","from","value","price","refreshTickets","i","tickets","call","owner","ticketEl","onclick","bind","appendChild","main","accounts","requestAccounts","innerText"],"sources":["C:/Users/Alex/Desktop/web3-tickets/client/src/index.js"],"sourcesContent":["import Web3 from 'web3';\r\nimport configuration from '../../build/contracts/Tickets.json';\r\nimport 'bootstrap/dist/css/bootstrap.css';\r\nimport ticketImage from './images/ticket.png';\r\n\r\nconst createElementFromString = (string) => {\r\n  const el = document.createElement('div');\r\n  el.innerHTML = string;\r\n  return el.firstChild;\r\n};\r\n\r\nconst CONTRACT_ADDRESS =\r\n  configuration.networks['5777'].address;\r\nconst CONTRACT_ABI = configuration.abi;\r\n\r\nconst web3 = new Web3(\r\n  Web3.givenProvider || 'http://127.0.0.1:7545'\r\n);\r\nconst contract = new web3.eth.Contract(\r\n  CONTRACT_ABI,\r\n  CONTRACT_ADDRESS\r\n);\r\n\r\nlet account;\r\n\r\nconst accountEl = document.getElementById('account');\r\nconst ticketsEl = document.getElementById('tickets');\r\nconst TOTAL_TICKETS = 10;\r\nconst EMPTY_ADDRESS =\r\n  '0x0000000000000000000000000000000000000000';\r\n\r\nconst buyTicket = async (ticket) => {\r\n  await contract.methods\r\n    .buyTicket(ticket.id)\r\n    .send({ from: account, value: ticket.price });\r\n};\r\n\r\nconst refreshTickets = async () => {\r\n  ticketsEl.innerHTML = '';\r\n  for (let i = 0; i < TOTAL_TICKETS; i++) {\r\n    const ticket = await contract.methods.tickets(i).call();\r\n    ticket.id = i;\r\n    if (ticket.owner === EMPTY_ADDRESS) {\r\n      const ticketEl = createElementFromString(\r\n        `<div class=\"ticket card\" style=\"width: 18rem;\">\r\n          <img src=\"${ticketImage}\" class=\"card-img-top\" alt=\"...\">\r\n          <div class=\"card-body\">\r\n            <h5 class=\"card-title\">Ticket</h5>\r\n            <p class=\"card-text\">${\r\n              ticket.price / 1e18\r\n            } Eth</p>\r\n            <button class=\"btn btn-primary\">Buy Ticket</button>\r\n          </div>\r\n        </div>`\r\n      );\r\n      ticketEl.onclick = buyTicket.bind(null, ticket);\r\n      ticketsEl.appendChild(ticketEl);\r\n    }\r\n  }\r\n};\r\n\r\nconst main = async () => {\r\n  const accounts = await web3.eth.requestAccounts();\r\n  account = accounts[0];\r\n  accountEl.innerText = account;\r\n  await refreshTickets();\r\n};\r\n\r\nmain();"],"mappings":"AAAA,OAAOA,IAAI,MAAM,MAAM;AACvB,OAAOC,aAAa,MAAM,oCAAoC;AAC9D,OAAO,kCAAkC;AACzC,OAAOC,WAAW,MAAM,qBAAqB;AAE7C,MAAMC,uBAAuB,GAAIC,MAAM,IAAK;EAC1C,MAAMC,EAAE,GAAGC,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;EACxCF,EAAE,CAACG,SAAS,GAAGJ,MAAM;EACrB,OAAOC,EAAE,CAACI,UAAU;AACtB,CAAC;AAED,MAAMC,gBAAgB,GACpBT,aAAa,CAACU,QAAQ,CAAC,MAAM,CAAC,CAACC,OAAO;AACxC,MAAMC,YAAY,GAAGZ,aAAa,CAACa,GAAG;AAEtC,MAAMC,IAAI,GAAG,IAAIf,IAAI,CACnBA,IAAI,CAACgB,aAAa,IAAI,uBACxB,CAAC;AACD,MAAMC,QAAQ,GAAG,IAAIF,IAAI,CAACG,GAAG,CAACC,QAAQ,CACpCN,YAAY,EACZH,gBACF,CAAC;AAED,IAAIU,OAAO;AAEX,MAAMC,SAAS,GAAGf,QAAQ,CAACgB,cAAc,CAAC,SAAS,CAAC;AACpD,MAAMC,SAAS,GAAGjB,QAAQ,CAACgB,cAAc,CAAC,SAAS,CAAC;AACpD,MAAME,aAAa,GAAG,EAAE;AACxB,MAAMC,aAAa,GACjB,4CAA4C;AAE9C,MAAMC,SAAS,GAAG,MAAOC,MAAM,IAAK;EAClC,MAAMV,QAAQ,CAACW,OAAO,CACnBF,SAAS,CAACC,MAAM,CAACE,EAAE,CAAC,CACpBC,IAAI,CAAC;IAAEC,IAAI,EAAEX,OAAO;IAAEY,KAAK,EAAEL,MAAM,CAACM;EAAM,CAAC,CAAC;AACjD,CAAC;AAED,MAAMC,cAAc,GAAG,MAAAA,CAAA,KAAY;EACjCX,SAAS,CAACf,SAAS,GAAG,EAAE;EACxB,KAAK,IAAI2B,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGX,aAAa,EAAEW,CAAC,EAAE,EAAE;IACtC,MAAMR,MAAM,GAAG,MAAMV,QAAQ,CAACW,OAAO,CAACQ,OAAO,CAACD,CAAC,CAAC,CAACE,IAAI,CAAC,CAAC;IACvDV,MAAM,CAACE,EAAE,GAAGM,CAAC;IACb,IAAIR,MAAM,CAACW,KAAK,KAAKb,aAAa,EAAE;MAClC,MAAMc,QAAQ,GAAGpC,uBAAuB,CACtC;AACR,sBAAsBD,WAAW;AACjC;AACA;AACA,mCACcyB,MAAM,CAACM,KAAK,GAAG,IAAI;AACjC;AACA;AACA,eAEM,CAAC;MACDM,QAAQ,CAACC,OAAO,GAAGd,SAAS,CAACe,IAAI,CAAC,IAAI,EAAEd,MAAM,CAAC;MAC/CJ,SAAS,CAACmB,WAAW,CAACH,QAAQ,CAAC;IACjC;EACF;AACF,CAAC;AAED,MAAMI,IAAI,GAAG,MAAAA,CAAA,KAAY;EACvB,MAAMC,QAAQ,GAAG,MAAM7B,IAAI,CAACG,GAAG,CAAC2B,eAAe,CAAC,CAAC;EACjDzB,OAAO,GAAGwB,QAAQ,CAAC,CAAC,CAAC;EACrBvB,SAAS,CAACyB,SAAS,GAAG1B,OAAO;EAC7B,MAAMc,cAAc,CAAC,CAAC;AACxB,CAAC;AAEDS,IAAI,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}